{% extends 'base.html.twig' %}

{% block stylesheets %}
{{ parent() }}
{% endblock %}

{% block body %}
<h1>Rechercher une classe</h1>

<table id="tab_classe" class="table table-striped table-bordered table-hover" style="width:100%">
    <thead>
    <tr>
        <th scope="col">Nom</th>
        <th scope="col">Responsable</th>
        <th scope="col">Modifier</th>
        <th scope="col">Supprimer</th>
    </tr>
    </thead>
    <tbody>
    {% for classe in classes %}
    <tr onmouseover="showModifs(this,{{ classe.id }})"  >
        <th id="{{ classe.id }}" >{{classe.nomClasse}}</th>
        {% if classe.professeurResponsable %}
            <td>{{classe.professeurResponsable.nomProfesseur}} {{classe.professeurResponsable.prenomProfesseur}}</td>
        {% else %}
            <td>(non assigné)</td>
        {% endif %}
        <td><a href="{{ path('classe_edit', {'id' : classe.id}) }}" class="edit-btn btn btn-warning active invisible">✎</a></td>
        <td><a href="{{ path('classe_delete', {'id' : classe.id}) }}" class="delete-btn btn btn-danger active invisible">❌</a></td>
    </tr>

    {% endfor %}
    </tbody>
</table>
<script>
function showModifs(tr,id){
    // Get all list buttons and pass them invisible
    const allEdit = Object.values(document.getElementsByClassName('edit-btn'));
    const allDel = Object.values(document.getElementsByClassName('delete-btn'));
    const allBtns = allEdit.concat(allDel);
    for(let i=0;i<allBtns.length;i++)
        allBtns[i].classList.add('invisible');

    //Make visible only the row buttons
    const editBtn = tr.getElementsByClassName('edit-btn')[0];
    const deleteBtn = tr.getElementsByClassName('delete-btn')[0];
    editBtn.classList.remove("invisible");
    deleteBtn.classList.remove("invisible");   
}
</script>

{% endblock %}
{%  block javascripts %}
    {{ parent() }}
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
<script  type="text/javascript">
    $(document).ready(function() {
        const table = $('#tab_classe').DataTable({
            select: true,
            scroll : 2000,
            lengthChange : false ,
            pageLength : 50,

        });

    } );

</script>
{% endblock %}