{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block body %}
    <h1>Rechercher un professeur</h1>

    {% for msg in app.session.flashBag.get('notDelete') %}
                    <div class="alert alert-primary">
                        {{ msg }}
                    </div>
                {% endfor %}

                {% for msg in app.session.flashBag.get('delete') %}
                                <div class="alert alert-success">
                                    {{ msg }}
                                </div>
                            {% endfor %}



    <table id="tab_professeurs" class="table table-striped table-bordered table-hover" style="width:100%">
        <thead>
        <tr>
            <th scope="col">Login</th>
            <th scope="col">Nom</th>
            <th scope="col">Prénom</th>
            <th scope="col">Mail Academique</th>
            <th scope="col">Modifier</th>
            <th scope="col">Supprimer</th>
        </tr>
        </thead>

        <tbody>
        {% for prof in profs %}
            <tr onmouseover="showModifs(this,{{ prof.id }})"  >
                <th id="{{ prof.id }}" >{{prof.login}}</th>
                <td>{{prof.nomProfesseur}}</td>
                <td>{{prof.prenomProfesseur}}</td>
                <td>{{prof.mailAcademique}}</td>
                <td><a href="{{ path('prof_edit', {'id' : prof.id}) }}" class="edit-btn btn btn-warning active invisible">✎</a></td>
                <td><a href="{{ path('prof_delete', {'id' : prof.id}) }}" class="delete-btn btn btn-danger active invisible">❌</a></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <a class="btn btn-success" href= {{ path('prof_add')}} role="button">Créer un professeur</a>
<script>
    function showModifs(tr,id){
        // Get all list buttons and pass them invisible
        const allEdit = Object.values(document.getElementsByClassName('edit-btn'));
        const allDel = Object.values(document.getElementsByClassName('delete-btn'));
        const allBtns = allEdit.concat(allDel);
        for(let i=0;i<allBtns.length;i++)
            allBtns[i].classList.add('invisible');

        //Make visible only the row buttons
        const editBtn = tr.getElementsByClassName('edit-btn')[0];
        const deleteBtn = tr.getElementsByClassName('delete-btn')[0];
        editBtn.classList.remove("invisible");
        deleteBtn.classList.remove("invisible");
    }
</script>
{% endblock %}

{%  block javascripts %}
    {{ parent() }}
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script  type="text/javascript">
        $(document).ready(function() {
            const table = $('#tab_professeurs').DataTable({
                select: true,
                scroll : 2000,
                lengthChange : false ,
                pageLength : 50,

            });
        } );
    </script>
{% endblock %}
