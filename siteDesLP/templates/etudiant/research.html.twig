{% extends 'base.html.twig' %}

{% block stylesheets %}
{{ parent() }}
{% endblock %}

{% block body %}
<h1>Rechercher un étudiant</h1>

<table id="tab_etudiant" class="table table-striped table-bordered table-hover" style="width:100%">
    <thead>
    <tr>
        <th scope="col">Login</th>
        <th scope="col">Nom Etudiant</th>
        <th scope="col">Prenom Etudiant</th>
        <th scope="col">Mail Academique</th>
        <th scope="col">Mail Personnel</th>
        <th scope="col">Date Naissance</th>
        <th scope="col">Modifier</th>
        <th scope="col">Supprimer</th>
    </tr>
    </thead>
    <tbody>
    {% for etudiant in etudiants %}
    <tr onmouseover="showModifs(this,{{ etudiant.id }})"  >
        <th id="{{ etudiant.id }}" >{{etudiant.login}}</th>
        <td>{{etudiant.nomEtudiant}}</td>
        <td>{{etudiant.prenomEtudiant}}</td>
        <td>{{etudiant.mailAcademique}}</td>
        <td>{{etudiant.mail}}</td>
        <td>{{etudiant.dateNaissance | date('d/m/Y')}}</td>
        <td><a href="{{ path('etudiant_edit', {'id' : etudiant.id}) }}" class="edit-btn btn btn-warning active invisible">✎</a></td>
        <td><a href="{{ path('etudiant_delete', {'id' : etudiant.id}) }}" class="delete-btn btn btn-danger active invisible">❌</a></td>
    </tr>

    {% endfor %}
    </tbody>
</table>
<a class="btn btn-success" href= {{ path('etudiant_create')}} role="button">Créer un étudiant</a>
<script>
function showModifs(tr,id){
    // Get all list buttons and pass them invisible
    const allEdit = Object.values(document.getElementsByClassName('edit-btn'));
    const allDel = Object.values(document.getElementsByClassName('delete-btn'));
    const allBtns = allEdit.concat(allDel);
    for(let i=0;i<allBtns.length;i++)
        allBtns[i].classList.add('invisible');

    //Make visible only the row buttons
    const editBtn = tr.getElementsByClassName('edit-btn')[0];
    const deleteBtn = tr.getElementsByClassName('delete-btn')[0];
    editBtn.classList.remove("invisible");
    deleteBtn.classList.remove("invisible");
}
</script>

{% endblock %}
{%  block javascripts %}
    {{ parent() }}
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
<script  type="text/javascript">
    $(document).ready(function() {
        const table = $('#tab_etudiant').DataTable({
            select: true,
            scroll : 2000,
            lengthChange : false ,
            pageLength : 50,

        });

    } );

</script>
{% endblock %}
